{% load humanize %}

    <div class="invoice-box">
        <table cellpadding="0" cellspacing="0">
            <tr class="top">
                <td colspan="4">
                    <table>
                        <tr>
                            <td class="title">
                                <img src="https://solinor.fi/wp-content/themes/twentyfifteen-child/images/logo-solinor@2x.png" style="width:100%; max-width:300px;">
                            </td>

                            <td>
                                Invoice #: 123<br>
                                Created: {{ today }}<br>
                                Due: {{ due_date }}
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>

            <tr class="information">
                <td colspan="4">
                    <table>
                        <tr>
                            <td>
                                Solinor Oy<br>
                                Teollisuuskatu 21<br>
                                00510 Helsinki
                            </td>

                            <td>
                                {{ client }}<br>
                                {{ project }}
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>



            {% for phase_name, phase in phases.items %}
            <tr class="heading">
                <td>
                    {{ phase_name }}
                </td>

                <td>
                  Bill rate
                </td>
                <td>
                    Hours
                </td>
                <td>
                    Price
                </td>
            </tr>
              {% for person_name, person_details in phase.users.items %}
                {% for bill_rate, details in person_details.items %}
                  {% if details.incurred_hours > 0 %}
                    <tr class="item">
                        <td>
                          {{ person_name }}
                        </td>

                        <td>
                          {{ bill_rate|floatformat:2 }}&euro;
                        </td>
                        <td>
                          {{ details.incurred_hours|floatformat:2 }}h
                        </td>
                        <td>
                          {% if not phase.billable %}<s>{% endif %}
                          {{ details.incurred_money|floatformat:2|intcomma }}&euro;
                          {% if not phase.billable %}</s>{% endif %}
                        </td>
                    </tr>
                  {% endif %}
                {% endfor %}
              {% endfor %}
            {% endfor %}

            <tr class="total">
                <td></td>
                <td>{{ bill_rate_avg|floatformat:2 }}&euro;</td>
                <td>
                  {{ total_hours|floatformat:2 }}h
                </td>

                <td>
                  {{ total_money|floatformat:2|intcomma }}&euro;
                </td>
            </tr>
        </table>
    </div>
